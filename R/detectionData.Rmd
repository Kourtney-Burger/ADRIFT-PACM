---
title: "PACM Detections"
author: "Kourtney Burger"
date: "2024-04-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Packages & Set Working Directory
## Load Packages
```{r}
library(here)
library(xlsx)
library(openxlsx)
library(tidyverse)
library(dplyr)
```

## Set Working Directory
```{r}
DepDir <- here::here()
```

# Taiki's helper function for dates

Helper function to create all the "YYYY-MM-DDThh:mm:ssZ" formatted date strings that JSON will want. *Note that this requires that you convert all your dates in the deploy details data that you read in earlier (or anywhere else you might read dates from) to POSIXct format.*
```{r}
posixToText <- function(x) {
    format(x, '%Y-%m-%dT%H:%M:%S')
}
```

# Read in Data
## Read in template
```{r}
Template <- xlsx::read.xlsx(here::here('PACM Templates/SWFSC_YYYYMMDD_DETECTIONDATA.xlsx'), sheetName = 'Detection_Data_Template')
```

## Read Detection data
```{r}
allDetections <- read.csv(here::here('R/detections/AllDetectionsHourly.csv'))
```

# Clean Detection Data

##Subset Detection Data
```{r}
# Subset PACM fields
detections <- subset(allDetections, select = c('UTC', 'species', 'call', 'DriftName'))
```

## Subset Project
```{r}
detections <- detections[str_detect(detections$DriftName, "ADRIFT"),]
```

## Convert Species Names to PACM Species Codes (from Taiki)
```{r}
detRename <- tribble(
    ~old, ~new,
    'B. borealis', 'SEWH', #Sei whale
    'Ba', 'MIWH', #Minke whale (common)
    'Bm', 'BLWH', #Blue whale
    'Bp', 'FIWH', #Fin whale
    'Er','GRWH', #Gray whale
    'Mn','HUWH', #Humpback whale
    'Pm', 'SPWH', #Sperm whale
    'Lo', 'PWDO', #Pacific white-sided dolphin
    'Gg', 'GRAM', #Risso's dolphin
    'ZC', 'GOBW', #Cuvier's beaked whale
    'BW', 'UNME', #Unidentified Beaked whale, Hyperoodontidae
    'UO', 'UNDO', #Unidentified dolphin, Odontoceti

#Add to PACM        
    'Anthro', 'ANTHRO', 
    'BB', 'BWBB', #beaked whale, Bairds/Berardius bairdii?  
    'BW43', 'BW43', #Unidentified Beaked whale 43kHz  
    'BWC', 'BWC', #Cross Beaked whale (Cross Seamount),  
    'MC', 'BWMC', #Hubb's/Mesoplodon carlhubbsi, formerly known as beaked whale 37V kHz 
    'MS', 'BWMS', #beaked whale, Stejneger's/Mesoplodon stejnegeri 
    'NBHF','NBHF', #Kogia, Dall's, and Harbor porpoise 
)

#Rename species
for(i in 1:nrow(detRename)) {
    detections$species[detections$species == detRename$old[i]] <- detRename$new[i]
}

#Check species codes
#sort(unique(detections$species))
```

## Convert Call Type to PACM Call Type Codes
```{r}
# Rename call types
callTypeRename <- tribble(
    ~old, ~new,
    #Fins
    '20Hz','FW20HZ',
    '40Hz','FW40HZ',

    #Blues
    'A', 'BLANEP',
    'B', 'BLBNEP',
    'D', 'BLDNEP',    
    
    #Dolphins
    'Clicks/A','ACLICKT', 
    'Clicks/B','BCLICKT', 
    'Whistles/<10kHz','ODWHIS',   
    'Whistles/<5kHz','ODWHIS',   
    'Whistles/>10kHz','ODWHIS',   
    'Whistles','ODWHIS',   
    
    #Minkes
    'Boing', 'MWNEPBOING',
    
    #Sperm Whale
    'Slow Clicks','SPSLC', #Sperm whale slow clicks
#    'Clicks','SPUSC', #Usual clicks, This is corrected below
    
    #Humpbacks 
    'Social','HWSOC', #Humpback social calls
    'Song','HWSONG', #Humpback song 

    #Sei whales
    'SWDS', 'SWDS',
    
    #Antrho
    'Ship/Broadband','NONBIO', #no PACM species for anthro sounds???
    'Ship/Low Frequency','NONBIO', #no PACM species for anthro sounds???
    'Ship/Narrowband','NONBIO' #no PACM species for anthro sounds???

    # Beaked whale call types 
#    '','FMUS', # corrected below
)

#Rename call types
for(i in 1:nrow(callTypeRename)) {
    detections$call[detections$call == callTypeRename$old[i]] <- callTypeRename$new[i]
}

# Rename calls matched to multiple species
#Correct humpback unidentified calls 
for (i in 1:nrow(detections)) {
  if (detections$species[i] == "HUWH") {
    if (detections$call[i] == "unidentified") {
      detections$call[i] <- "HWUND"
    }
  }
}
#Correct gray unidentified calls 
for (i in 1:nrow(detections)) {
  if (detections$species[i] == "GRWH") {
    if (detections$call[i] == "unidentified") {
      detections$call[i] <- "GWUND"
    }
  }
}

# Correct sperm whale clicks
for (i in 1:nrow(detections)) {
  if (detections$species[i] == "SPWH") {
    if (is.na(detections$call[i]) || detections$call[i] == "Clicks") {
      detections$call[i] <- "SPUSC"
    }
  }
}

# Correct dolphin clicks
for (i in 1:nrow(detections)) {
  if (detections$species[i] == "GRAM" || detections$species[i] == "PWDO" || detections$species[i] == "UNDO") {
    if (detections$call[i] == "Clicks" || is.na(detections$call[i])) {
      detections$call[i] <- "ODCLICK"
    }
  }
}


# Beaked whale call types all set as FMUS (frequency modulated upsweep)
for (i in 1:nrow(detections)) {
  if (detections$species[i] == "BW43" || detections$species[i] == "BWBB" || detections$species[i] == "BWC" || detections$species[i] == "BWMC" || detections$species[i] == "BWMS" || detections$species[i] == "GOBW" || detections$species[i] == "UNME") {
    if (is.na(detections$call[i])) {
      detections$call[i] <- "FMUS"
    }
  }
}

# Set NBHF Call type
for (i in 1:nrow(detections)) {
  if (detections$species[i] == "NBHF") {
    if (is.na(detections$call[i])) {
      detections$call[i] <- "NBHF"
    }
  }
}

#Check species and call types
table(detections$species, detections$call)
```

## Add end time and convert dates
```{r}
# Add end time 
detections$UTC <- as.POSIXct(detections$UTC, format = "%Y-%m-%d %H:%M:%S", tz = 'UTC')

detections$end <- detections$UTC

for (i in 1:nrow(detections)) {
  detections$end[i] <- detections$end[i] + 3599
}

detections$UTC <- posixToText(as.POSIXct(detections$UTC, format = "%Y-%m-%d %H:%M:%S", tz = 'UTC'))
detections$end <- posixToText(as.POSIXct(detections$end, format = "%Y-%m-%d %H:%M:%S", tz = 'UTC'))

for (i in 1:nrow(detections)) {
  detections$UTC[i] <- paste0(detections$UTC[i],'Z')
  detections$end[i] <- paste0(detections$end[i],'Z')
}
```

## Create PACM Dataframe
```{r}
# Add additional PACM Columns
PACMdetections <- detections %>% 
  add_column('ANALYSIS_TIME_ZONE' = 'UTC', 'ACOUSTIC_PRESENCE' = '', 'N_VALIDATED_DETECTIONS' = '', 'DETECTION_METHOD' = '', 'PROTOCOL_REFERENCE' = '', 'DETECTION_SOFTWARE_NAME' = '', 'DETECTION_SOFTWARE_VERSION' = '', 'MIN_ANALYSIS_FREQUENCY_RANGE_HZ' = '', 'MAX_ANALYSIS_FREQUENCY_RANGE_HZ' = '', 'QC_PROCESSING' = 'Archival', 'LOCALIZED_LATITUDE' = '', 'LOCALIZED_LONGITUDE' = '', 'DETECTION_DISTANCE_M' = '', 'LOCALIZATION_DISTANCE_METHOD' = '', 'LOCALIZATION_DISTANCE_PROTOCOL' = '')

# Reorder Columns
#PACMdetections <- PACMdetections[, c(4,1,5,6,2,7,8,9,3,10,11,12,13,14,15,16,17,18,19,20)]

# Rename Columns
PACMdetections <- PACMdetections %>%
  dplyr::rename(UNIQUE_ID = DriftName, ANALYSIS_PERIOD_START_DATETIME = UTC, ANALYSIS_PERIOD_END_DATETIME = end, SPECIES_CODE = species, CALL_TYPE_CODE = call)
```

## Rename UNIQUE_ID
Need to match current detections 'UNIQUE_ID' to the metadata 'UNIQUE_ID'
```{r}
# Remove pascal 14 detections
# PACMdetections <- subset(PACMdetections, UNIQUE_ID != "PASCAL_014")

# Read in metadata
metadata <- read.csv(here::here('PACM Worksheets/ADRIFT/SWFSC_ADRIFT_20240617_METADATA.csv'))

metaFactorName <- as.factor(metadata$UNIQUE_ID)
PACMdetections$UNIQUE_ID = as.factor(PACMdetections$UNIQUE_ID)
levels(PACMdetections$UNIQUE_ID) = metaFactorName
```

## Pull Sampling Rate from Metadata
```{r}
metadata$ANALYSIS_SAMPLING_RATE_HZ <- metadata$SAMPLING_RATE_HZ
PACMdetections = merge(PACMdetections,
                       metadata[,c('UNIQUE_ID','ANALYSIS_SAMPLING_RATE_HZ')],
                       by = 'UNIQUE_ID', all.x = TRUE)

# Reorder Columns
#PACMdetections <- PACMdetections[, c(4,1,5,6,7,2,8,9,3,10,11,12,13,14,15,21,16,17,18,19,20)]
```

## Correct Analysis Period Effort
```{r}
#CHANGE 'ANALYSIS_PERIOD_EFFORT_SECONDS', if continuous = 86400
SampMetadata <- metadata[, c(1,21,22)]
SampMetadata$RECORDING_INTERVAL_SECONDS <- SampMetadata$RECORDING_DURATION_SECONDS+SampMetadata$RECORDING_INTERVAL_SECONDS
SampMetadata <- SampMetadata %>% 
  add_column('Ratio' = as.character(SampMetadata$RECORDING_DURATION_SECONDS/SampMetadata$RECORDING_INTERVAL_SECONDS), 'ANALYSIS_PERIOD_EFFORT_SECONDS' = '')

for (i in 1:nrow(SampMetadata)) {
  if (SampMetadata$Ratio[i] == '1') {
    SampMetadata$ANALYSIS_PERIOD_EFFORT_SECONDS[i] <- 86400
  }
  else {
    SampMetadata$ANALYSIS_PERIOD_EFFORT_SECONDS[i] <- as.character(as.numeric(SampMetadata$Ratio[i])*3600)
  }
}

PACMdetections = merge(PACMdetections,
                       SampMetadata[,c('UNIQUE_ID','ANALYSIS_PERIOD_EFFORT_SECONDS')],
                       by = 'UNIQUE_ID', all.x = TRUE)

# Reorder Columns
PACMdetections <- PACMdetections[, c(1,2,5,22,6,3,7,8,4,9,10,11,12,13,14,21,15,16,17,18,19,20)]
```


# Tidy Detections
## New progress bar
```{r}
# Set up progress bar
pb <- txtProgressBar(min = 0,      # Minimum value of the progress bar
                     max = nrow(PACMdetections), # Maximum value of the progress bar
                     style = 3,    # Progress bar style (also available style = 1 and style = 2)
                     width = 50,   # Progress bar width. Defaults to getOption("width")
                     char = "=")   # Character used to create the bar
```


## Minke - Kourtney
```{r}
# No minkes in adrift
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "MIWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "PAMGuard GPL"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "PAMGuard"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "2.02.02"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "12000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Blue - Cory
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "BLWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "Manual"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "Matlab (Triton)"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "1.93.20160524"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "250"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Brydes/Sei - Cory/Liz
```{r}
#No Bryde's detections in data
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "BRWH" || PACMdetections$SPECIES_CODE[i] == "SEWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <-  "D"
    PACMdetections$DETECTION_METHOD[i] <- "PAMGuard Whistle and Moan Detector"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "PAMGuard"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "2.01.09"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "250"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Gray - Kaitlin
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "GRWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "P"
    PACMdetections$DETECTION_METHOD[i] <- "Manual"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Guazzo, R. A., Helble, T. A., D’Spain, G. L., Weller, D. W., Wiggins, S. M., & Hildebrand, J. A. (2017). Migratory behavior of eastern North Pacific gray whales tracked using a hydrophone array. PLOS ONE, 12(10), e0185585. https://doi.org/10.1371/journal.pone.0185585"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "RAVEN Pro"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "1.6"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "3000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Humpback - Kaitlin
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "HUWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "Manual"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "RAVEN Pro"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "1.6"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "3000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## NBHF - Anne
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "NBHF") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "PAMGuard Click Detector; PAMGuard Match Template Classifier"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "https://sael-swfsc.github.io/adrift-analysis-methods/content/ToothedWhales/NBHF-Detection.html"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "PAMGuard"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "2.02.09f"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "384000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Sperm Whales - Anne
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "SPWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "Manual"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "Matlab (Triton)"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "Triton 1.0 2021 09 21"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "48000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Dolphins - Anne
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "PWDO" || PACMdetections$SPECIES_CODE[i] == "GRAM" || PACMdetections$SPECIES_CODE[i] == "UNDO") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "Manual"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Soldevilla, M. S., Henderson, E. E., Campbell, G. S., Wiggins, S. M., Hildebrand, J. A., & Roch, M. A. (2008). Classification of Risso’s and Pacific white-sided dolphins using spectral properties of echolocation clicks. The Journal of the Acoustical Society of America, 124(1), 609–624. https://doi.org/10.1121/1.2932059"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "Matlab (Triton)"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "Triton 1.0 2021 09 21"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "100000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```

## Beaked Whales - Anne
```{r}
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "GOBW" || PACMdetections$SPECIES_CODE[i] == "BB" || PACMdetections$SPECIES_CODE[i] == "BW43" || PACMdetections$SPECIES_CODE[i] == "BWC" || PACMdetections$SPECIES_CODE[i] == "MC" || PACMdetections$SPECIES_CODE[i] == "MS" || PACMdetections$SPECIES_CODE[i] == "UNME") { 
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$DETECTION_METHOD[i] <- "PAMGuard Click Detector"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Simonis et al 2020 (https://swfsc-publications.fisheries.noaa.gov/publications/CR/2020/2020Simonis3.pdf) "
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "PAMGuard"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "2.02.09f"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "288000"
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection
```
## Fin - Cory/Liz  
### NOTE DIFFERENT METHODS FOR DIFFERENT PROJECTS
```{r}
# ADRIFT
for (i in 1:nrow(PACMdetections)) {
  if (PACMdetections$SPECIES_CODE[i] == "FIWH") {
    PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
    PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
    PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "PAMGuard"
    PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "2.01.09"
    PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
    PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "250"

    if (PACMdetections$CALL_TYPE_CODE[i] == "FWPLS") { # 20 Hz calls
      PACMdetections$DETECTION_METHOD[i] <- "PAMGuard Click Detector"
    }
    else { # 40 Hz calls
      PACMdetections$DETECTION_METHOD[i] <- "Manual"
    }
  }
  # Sets the progress bar to the current state
  setTxtProgressBar(pb, i)
}
close(pb) # Close the connection

# CCES/PASCAL
# for (i in 1:nrow(PACMdetections)) {
#   if (PACMdetections$SPECIES_CODE[i] == "FIWH") {
#     PACMdetections$ACOUSTIC_PRESENCE[i] <- "D"
#     PACMdetections$DETECTION_METHOD[i] <- "Manual"
#     PACMdetections$PROTOCOL_REFERENCE[i] <- "Unpublished"
#     PACMdetections$MIN_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "0"
#     PACMdetections$MAX_ANALYSIS_FREQUENCY_RANGE_HZ[i] <- "250"
# 
#     if (PACMdetections$CALL_TYPE_CODE[i] == "FWDS") { #40 Hz calls
#       PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "PAMGuard"
#       PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "2.01.09"
#     }
#     else { # 20 Hz calls
#       PACMdetections$DETECTION_SOFTWARE_NAME[i] <- "Matlab (Triton)"
#       PACMdetections$DETECTION_SOFTWARE_VERSION[i] <- "1.93.20160524"
#     }
#   }
#   # Sets the progress bar to the current state
#   setTxtProgressBar(pb, i)
# }
# close(pb) # Close the connection
```

## Anthro? 


# Export Metadata
```{r}
#Save subsample for PACM testing
# PACMdetectionsSubsample <- PACMdetections[1:100000, ]
# write.csv(PACMdetectionsSubsample, "~/GitHub/ADRIFT-PACM/PACM Worksheets/ADRIFT/Subsample-SWFSC_20240410_DETECTIONDATA.csv", row.names=FALSE)

#Exclude NBHF until species classifier is ran
#PACMdetections <- PACMdetections[(PACMdetections$SPECIES_CODE != 'NBHF'), ]

write.csv(PACMdetections, "~/GitHub/ADRIFT-PACM/PACM Worksheets/ADRIFT/SWFSC_ADRIFT_20240617_DETECTIONDATA.csv", row.names=FALSE)
```